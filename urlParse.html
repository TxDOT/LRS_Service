<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>LRS URL Params</title>
    <!-- ArcGIS JS 4 CDN -->
    <script src="https://js.arcgis.com/4.15/"></script>
    <!-- TPP Framework -->
    <!-- <script src="https://cdn.jsdelivr.net/gh/TxDOT/Framework/framework_1.0.js"></script> -->
    <script>
        function parseURL(url) {
            let parser = document.createElement('a'),
                urlObj = {},
                queries, split, i, xy;
            parser.href = url;
            queries = parser.search.replace(/^\?/, '').split('&');
            for( i = 0; i < queries.length; i++ ) {
                let split = queries[i].split('=');
                urlObj[split[0]] = split[1];
            }
            split = urlObj.coords.split(',');
            urlObj.x = split[0];
            urlObj.y = split[1];
            delete urlObj['coords'];
            return {urlObj: urlObj};
        }
    </script>
    <!-- LRS API CDN -->
    <script src="https://cdn.jsdelivr.net/gh/TxDOT/LRS_Service/scripts/lrs.js"></script>
    <script>
        const load = () => {
            const urlParams = parseURL(document.URL);
            console.log(urlParams);
            const point = lrsAPI.getParams(Number(urlParams.urlObj.y),Number(urlParams.urlObj.x));
            console.log(point);
            const lrsParams = lrsAPI.identRouteForM(point,urlParams.urlObj.buff,urlParams.urlObj.lrm,"output");
          }
          window.onload = load;
    </script>
</head>
<body id="output" style="white-space: pre-wrap; font-family: monospace; font-size: 2em;"></body>
</html>
